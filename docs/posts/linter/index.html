<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>fixing code style with style | xie</title>
<meta name=keywords content="machine learning,python,openai"><meta name=description content="Key Topics OpenAI API Function Chains Validation Prompt Engineering Abstract In my university computer science course, we have an extensive code standard. We are provided with a linter that is a bash script and identifies most errors, but it doesn&rsquo;t cover every case, such as embedded constants and local variable definitions. In this project, I will focus on embedded constants and cover 1. identifying these, and 2, fixing these.
The strategy I use to solve this issue can be applied to anything similar."><meta name=author content="daniel"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://example.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://example.net/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://example.net/favicon.ico><link rel=apple-touch-icon href=https://example.net/favicon.ico><link rel=mask-icon href=https://example.net/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://example.net/posts/linter/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="fixing code style with style"><meta property="og:description" content="Key Topics OpenAI API Function Chains Validation Prompt Engineering Abstract In my university computer science course, we have an extensive code standard. We are provided with a linter that is a bash script and identifies most errors, but it doesn&rsquo;t cover every case, such as embedded constants and local variable definitions. In this project, I will focus on embedded constants and cover 1. identifying these, and 2, fixing these.
The strategy I use to solve this issue can be applied to anything similar."><meta property="og:type" content="article"><meta property="og:url" content="https://example.net/posts/linter/"><meta property="og:image" content="https://example.net/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="og:site_name" content="xie"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://example.net/%3Cimage%20path/url%3E"><meta name=twitter:title content="fixing code style with style"><meta name=twitter:description content="Key Topics OpenAI API Function Chains Validation Prompt Engineering Abstract In my university computer science course, we have an extensive code standard. We are provided with a linter that is a bash script and identifies most errors, but it doesn&rsquo;t cover every case, such as embedded constants and local variable definitions. In this project, I will focus on embedded constants and cover 1. identifying these, and 2, fixing these.
The strategy I use to solve this issue can be applied to anything similar."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://example.net/posts/"},{"@type":"ListItem","position":2,"name":"fixing code style with style","item":"https://example.net/posts/linter/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"fixing code style with style","name":"fixing code style with style","description":"Key Topics OpenAI API Function Chains Validation Prompt Engineering Abstract In my university computer science course, we have an extensive code standard. We are provided with a linter that is a bash script and identifies most errors, but it doesn\u0026rsquo;t cover every case, such as embedded constants and local variable definitions. In this project, I will focus on embedded constants and cover 1. identifying these, and 2, fixing these.\nThe strategy I use to solve this issue can be applied to anything similar.","keywords":["machine learning","python","openai"],"articleBody":"Key Topics OpenAI API Function Chains Validation Prompt Engineering Abstract In my university computer science course, we have an extensive code standard. We are provided with a linter that is a bash script and identifies most errors, but it doesn’t cover every case, such as embedded constants and local variable definitions. In this project, I will focus on embedded constants and cover 1. identifying these, and 2, fixing these.\nThe strategy I use to solve this issue can be applied to anything similar. To incite thought, think about something that is redundant. If you are familiar with large language models, think about something a large language model could help you automate. Anyways here is an example:\nHere is a Bad Example of Embedded Constant: if (temperature \u003e 10) /* DO NOT USE */ Again, in this case the value means something, and you should define a constant instead... #define MAX_TEMPERATURE (10) First Approach I will be referencing the ChatGPT API quite a bit in the following text. If you are not comfortable with terminology, here is the link to the offical documentation. I am proceeding assuming you know how an API works and what it does.\nThe first approach I did was to do both steps (identifying and fixing) in one step. My API Request looked similar to this.\ncompletion = client.chat.completions.create( model=\"gpt-4\", messages=[ {\"role\": \"system\", \"content\": \"\"\" Code Standard Check: 'IX. DEFENSIVE CODING TECHNIQUE' compliance for C code. This tool inspects C code for adherence to defensive programming practices. Rules: - (IX.A) Check or return the function's return value for error conditions. - (IX.B) Use fclose to close files opened with fopen and set the file pointer to NULL afterwards. - (IX.C) After using free on a pointer, set it to NULL. - (IX.D) Perform range checking on function parameters. - (IX.E) Use the correct typed symbol to represent 0 and NULL. Violation Examples: - Rule IX.A Violations (EXTREMELY IMPORTANT): FILE *file = fopen(\"data.txt\", \"r\"); // Missing check for NULL after fopen char *data = (char *)malloc(100); // Missing check for NULL after malloc size_t result = fwrite(buffer, sizeof(char), 100, file); // Missing check on fwrite return value - Rule IX.B Violations: (EXTREMELY IMPORTANT) FILE *file = fopen(\"data.txt\", \"w\"); fclose(file); // Missing file pointer set to NULL after fclose file = fopen(\"data.txt\", \"r\"); if (file) { /* ... */ fclose(file); } // Correct use, but missing setting pointer to NULL - Rule IX.C Violations: char *data = (char *)malloc(50); free(data); // Missing set to NULL after free int *numbers = (int *)calloc(20, sizeof(int)); free(numbers); // Correct free, but missing set to NULL - Rule IX.D Violations void setTemperature(int temperature) { if (temperature \u003c 0 || temperature \u003e 100) { /* ... */ } } // Missing standardized range checking if (age \u003e= 18 \u0026\u0026 age \u003c= 130) { /* ... */ } // Correct range, but consider using constants for readability - Rule IX.E Violations: int is_done = NULL; // Incorrect symbol, should use 0 for integers float value = NULL; // Incorrect symbol, should use 0.0 for reals Error Reporting Format: The following are the Error definitions to use: - (IX.A) Check Function Return - Ensure return values of functions are checked or returned. - (IX.B) File Close - Ensure files are closed and pointers are set to NULL. - (IX.C) Pointer Reset After Free - Ensure pointers are set to NULL after free. - (IX.D) Parameter Range Checking - Ensure parameters are within expected range. - (IX.E) Typed Symbol Usage - Ensure the correct symbol is used for 0 and NULL. - Errors are reported as '[RULE].[LETTER] - Error definition - Error Description, followed by a new line. [IX.A] - Check Function Return - FILE *file = fopen(\"data.txt\", \"r\"); - Missing check for NULL after fopen. [IX.B] - File Close - FILE *file = fopen(\"data.txt\", \"w\"); fclose(file); - Missing file pointer set to NULL after fclose. [IX.C] - Pointer Reset After Free - char *data = (char *)malloc(50); free(data); - Missing set to NULL after free. [IX.D] - Parameter Range Checking - void setTemperature(int temperature) { if (temperature \u003c 0 || temperature \u003e 100) { /* ... */ } } - Missing standardized range checking. [IX.E] - Typed Symbol Usage - int is_done = NULL; - Incorrect symbol, should use 0 for integers. Example Response: The prompt should only have the error codes. No extra text. Alphabetical order. If no errors are found, the response should be empty. [IX.A] - Check Function Return - FILE *file = fopen(\"data.txt\", \"r\"); - Missing check for NULL after fopen. [IX.A] - Check Function Return - char *data = (char *)malloc(100); - Missing check for NULL after malloc. [IX.C] - Pointer Reset After Free - int *numbers = (int *)calloc(20, sizeof(int)); free(numbers); - Correct free, but missing set to NULL. \"\"\" }, {\"role\": \"user\", \"content\": text_data} ] ) response = completion.choices[0].message.content However, this did not work. Something I quickly learned was the bigger the system prompt, the higher chance the language model has to forget, skip over something, or mess up in general. Also, I was simply copy and pasting straight from the code standard and passing in vague examples.\nI had to separate each step for more accurate results. Reiterating, there are two key steps for solving the issue of embedded constants.\n1. Identify which Constants are wrong. 2. Modify the Code to reflect the changes. First, I aimed to do step 1 in its own request. This means the language model is ONLY trying to identify constants, it’s not trying to fix them as well which allows for better focus on the task.\nThis is the system prompt I passed in:\n\"role\": \"system\", \"content\": Analyze the provided code snippets and identify any instances where literal numbers (embedded constants) are used directly in conditions, return statements, or variable initializations. Instead of using these literals directly, suggest defining them as constants at the beginning of the program to improve code readability and maintainability. Return these values and their line numbers in a python dictionary in the format of [constant_value]:[line_number] Once I had access to the constants to check and their line numbers, the second api request was quite straightfoward. I passed in the dictionary and the code, and the language model knew exactly where to look, completely removing the effort for searching.\nThis proved quite effective in producing accurate results. Here is the full completion request for the second prompt.\nmessages = [ {\"role\": \"system\", \"content\": You will be given a dictionary in formatted as constant:line_number. Navigate to that line number and determine if the constant holds intrinsic value. If it does, keep it. If it doesn't, create a #define at the top of the code and replace the constant with it's new constant. Be sure to go through all dictionary elements. }, {\"role\": \"user\", \"content\": entire_code} I’ve been using this for my homework and it’s worked pretty well over the semester. While this definitely could be automated using hard code and not API’s, it still is an interesting way to manipulate API requests into creating more accurate results.\n","wordCount":"1178","inLanguage":"en","image":"https://example.net/%3Cimage%20path/url%3E","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"daniel"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://example.net/posts/linter/"},"publisher":{"@type":"Organization","name":"xie","logo":{"@type":"ImageObject","url":"https://example.net/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://example.net/ accesskey=h title="dx (Alt + H)"><img src=https://example.net/apple-touch-icon.png alt aria-label=logo height=35>dx</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://example.net/tags/ title=projects><span>projects</span></a></li><li><a href=https://example.net/categories/ title=categories><span>categories</span></a></li><li><a href=https://example.net/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://example.net/>Home</a>&nbsp;»&nbsp;<a href=https://example.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">fixing code style with style</h1><div class=post-meta>daniel&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/linter.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#first-approach>First Approach</a><ul><li><a href=#1-identify-which-constants-are-wrong><code>1. Identify which Constants are wrong.</code></a></li><li><a href=#2-modify-the-code-to-reflect-the-changes><code>2. Modify the Code to reflect the changes.</code></a></li></ul></li></ul></nav></div></details></div><div class=post-content><h1 id=key-topics>Key Topics<a hidden class=anchor aria-hidden=true href=#key-topics>#</a></h1><ul><li><strong>OpenAI API</strong></li><li><strong>Function Chains</strong></li><li><strong>Validation</strong></li><li><strong>Prompt Engineering</strong></li></ul><h1 id=abstract>Abstract<a hidden class=anchor aria-hidden=true href=#abstract>#</a></h1><p>In my university computer science course, we have an extensive code standard. We are provided with a linter that is a bash script and identifies most errors, but it doesn&rsquo;t cover every case, such as <strong>embedded constants</strong> and <strong>local variable definitions</strong>. In this project, I will focus on <strong>embedded constants</strong> and cover 1. identifying these, and 2, fixing these.</p><p>The strategy I use to solve this issue can be applied to anything similar. To incite thought, think about <em>something that is redundant</em>. If you are familiar with large language models, think about something a large language model could help you automate. Anyways here is an example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>Here</span> <span class=n>is</span> <span class=n>a</span> <span class=n>Bad</span> <span class=n>Example</span> <span class=n>of</span> <span class=n>Embedded</span> <span class=nl>Constant</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>temperature</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>)</span>   <span class=cm>/* DO NOT USE */</span>
</span></span><span class=line><span class=cl><span class=n>Again</span><span class=p>,</span> <span class=n>in</span> <span class=n>this</span> <span class=k>case</span> <span class=n>the</span> <span class=n>value</span> <span class=n>means</span> <span class=n>something</span><span class=p>,</span> <span class=n>and</span> <span class=n>you</span>
</span></span><span class=line><span class=cl><span class=n>should</span> <span class=n>define</span> <span class=n>a</span> <span class=n>constant</span> <span class=n>instead</span><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=cp>#define MAX_TEMPERATURE  (10)
</span></span></span></code></pre></div><h2 id=first-approach>First Approach<a hidden class=anchor aria-hidden=true href=#first-approach>#</a></h2><p>I will be referencing the ChatGPT API quite a bit in the following text. If you are not comfortable with terminology, here is the link to the offical <a href=https://platform.openai.com/docs/api-reference>documentation</a>. I am proceeding assuming you know how an API works and what it does.</p><p>The first approach I did was to do both steps (identifying and fixing) in <strong>one</strong> step. My API Request looked similar to this.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>completion</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>chat</span><span class=o>.</span><span class=n>completions</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=s2>&#34;gpt-4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>Code Standard Check: &#39;IX. DEFENSIVE CODING TECHNIQUE&#39; compliance for C code. This tool inspects C code for adherence to defensive programming practices.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Rules:
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.A) Check or return the function&#39;s return value for error conditions.
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.B) Use fclose to close files opened with fopen and set the file pointer to NULL afterwards.
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.C) After using free on a pointer, set it to NULL.
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.D) Perform range checking on function parameters.
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.E) Use the correct typed symbol to represent 0 and NULL.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Violation Examples:
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>- Rule IX.A Violations (EXTREMELY IMPORTANT):
</span></span></span><span class=line><span class=cl><span class=s2>  FILE *file = fopen(&#34;data.txt&#34;, &#34;r&#34;); // Missing check for NULL after fopen
</span></span></span><span class=line><span class=cl><span class=s2>  char *data = (char *)malloc(100); // Missing check for NULL after malloc
</span></span></span><span class=line><span class=cl><span class=s2>  size_t result = fwrite(buffer, sizeof(char), 100, file); // Missing check on fwrite return value
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>- Rule IX.B Violations: (EXTREMELY IMPORTANT)
</span></span></span><span class=line><span class=cl><span class=s2>  FILE *file = fopen(&#34;data.txt&#34;, &#34;w&#34;); fclose(file); // Missing file pointer set to NULL after fclose
</span></span></span><span class=line><span class=cl><span class=s2>  file = fopen(&#34;data.txt&#34;, &#34;r&#34;); if (file) { /* ... */ fclose(file); } // Correct use, but missing setting pointer to NULL
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>- Rule IX.C Violations:
</span></span></span><span class=line><span class=cl><span class=s2>  char *data = (char *)malloc(50); free(data); // Missing set to NULL after free
</span></span></span><span class=line><span class=cl><span class=s2>  int *numbers = (int *)calloc(20, sizeof(int)); free(numbers); // Correct free, but missing set to NULL
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>- Rule IX.D Violations
</span></span></span><span class=line><span class=cl><span class=s2>  void setTemperature(int temperature) { if (temperature &lt; 0 || temperature &gt; 100) { /* ... */ } } // Missing standardized range checking
</span></span></span><span class=line><span class=cl><span class=s2>  if (age &gt;= 18 &amp;&amp; age &lt;= 130) { /* ... */ } // Correct range, but consider using constants for readability
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>- Rule IX.E Violations:
</span></span></span><span class=line><span class=cl><span class=s2>  int is_done = NULL; // Incorrect symbol, should use 0 for integers
</span></span></span><span class=line><span class=cl><span class=s2>  float value = NULL; // Incorrect symbol, should use 0.0 for reals
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Error Reporting Format:
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>The following are the Error definitions to use: 
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.A) Check Function Return - Ensure return values of functions are checked or returned.
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.B) File Close - Ensure files are closed and pointers are set to NULL.
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.C) Pointer Reset After Free - Ensure pointers are set to NULL after free.
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.D) Parameter Range Checking - Ensure parameters are within expected range.
</span></span></span><span class=line><span class=cl><span class=s2>- (IX.E) Typed Symbol Usage - Ensure the correct symbol is used for 0 and NULL.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>- Errors are reported as &#39;[RULE].[LETTER] - Error definition - Error Description, followed by a new line.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>[IX.A] - Check Function Return - FILE *file = fopen(&#34;data.txt&#34;, &#34;r&#34;); - Missing check for NULL after fopen.
</span></span></span><span class=line><span class=cl><span class=s2>[IX.B] - File Close - FILE *file = fopen(&#34;data.txt&#34;, &#34;w&#34;); fclose(file); - Missing file pointer set to NULL after fclose.
</span></span></span><span class=line><span class=cl><span class=s2>[IX.C] - Pointer Reset After Free - char *data = (char *)malloc(50); free(data); - Missing set to NULL after free.
</span></span></span><span class=line><span class=cl><span class=s2>[IX.D] - Parameter Range Checking - void setTemperature(int temperature) { if (temperature &lt; 0 || temperature &gt; 100) { /* ... */ } } - Missing standardized range checking.
</span></span></span><span class=line><span class=cl><span class=s2>[IX.E] - Typed Symbol Usage - int is_done = NULL; - Incorrect symbol, should use 0 for integers.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Example Response:
</span></span></span><span class=line><span class=cl><span class=s2>The prompt should only have the error codes. No extra text. Alphabetical order.
</span></span></span><span class=line><span class=cl><span class=s2>If no errors are found, the response should be empty.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>[IX.A] - Check Function Return - FILE *file = fopen(&#34;data.txt&#34;, &#34;r&#34;); - Missing check for NULL after fopen.
</span></span></span><span class=line><span class=cl><span class=s2>[IX.A] - Check Function Return - char *data = (char *)malloc(100); - Missing check for NULL after malloc.
</span></span></span><span class=line><span class=cl><span class=s2>[IX.C] - Pointer Reset After Free - int *numbers = (int *)calloc(20, sizeof(int)); free(numbers); - Correct free, but missing set to NULL.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>text_data</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>response</span> <span class=o>=</span> <span class=n>completion</span><span class=o>.</span><span class=n>choices</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>message</span><span class=o>.</span><span class=n>content</span>
</span></span></code></pre></div><p>However, this did not work. Something I quickly learned was the <strong>bigger</strong> the system prompt, the higher chance the language model has to <em>forget, skip over something, or mess up in general</em>. Also, I was simply copy and pasting straight from the code standard and passing in vague examples.</p><p>I had to separate each step for more accurate results. Reiterating, there are <code>two</code> key steps for solving the issue of embedded constants.</p><h3 id=1-identify-which-constants-are-wrong><code>1. Identify which Constants are wrong.</code><a hidden class=anchor aria-hidden=true href=#1-identify-which-constants-are-wrong>#</a></h3><h3 id=2-modify-the-code-to-reflect-the-changes><code>2. Modify the Code to reflect the changes.</code><a hidden class=anchor aria-hidden=true href=#2-modify-the-code-to-reflect-the-changes>#</a></h3><p>First, I aimed to do step 1 in its <strong>own request</strong>. This means the language model is ONLY trying to identify constants, it&rsquo;s not trying to fix them as well which allows for better focus on the task.</p><p>This is the system prompt I passed in:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>Analyze the provided code snippets and identify any instances
</span></span><span class=line><span class=cl>where literal numbers (embedded constants) are used directly
</span></span><span class=line><span class=cl>in conditions, return statements, or variable initializations.
</span></span><span class=line><span class=cl>Instead of using these literals directly, suggest defining them
</span></span><span class=line><span class=cl>as constants at the beginning of the program to improve code
</span></span><span class=line><span class=cl>readability and maintainability. Return these values and their
</span></span><span class=line><span class=cl>line numbers in a python dictionary in the format of
</span></span><span class=line><span class=cl>[constant_value]:[line_number]
</span></span></code></pre></div><p>Once I had access to the constants to check and their line numbers, the second api request was quite straightfoward. I passed in the dictionary and the code, and the language model knew exactly where to look, completely removing the effort for searching.</p><p>This proved quite effective in producing accurate results. Here is the full completion request for the second prompt.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>messages = [
</span></span><span class=line><span class=cl>  {&#34;role&#34;: &#34;system&#34;, &#34;content&#34;:
</span></span><span class=line><span class=cl>  You will be given a dictionary in formatted as constant:line_number.
</span></span><span class=line><span class=cl>  Navigate to that line number and determine if the constant holds intrinsic
</span></span><span class=line><span class=cl>  value. If it does, keep it. If it doesn&#39;t, create a #define at the top of the code and replace the constant with it&#39;s new constant. Be sure to go through all
</span></span><span class=line><span class=cl>  dictionary elements.
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>  {&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: entire_code}
</span></span></code></pre></div><p>I&rsquo;ve been using this for my homework and it&rsquo;s worked pretty well over the semester. While this definitely could be automated using hard code and not API&rsquo;s, it still is an interesting way to manipulate API requests into creating more accurate results.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://example.net/tags/machine-learning/>Machine Learning</a></li><li><a href=https://example.net/tags/python/>Python</a></li><li><a href=https://example.net/tags/openai/>Openai</a></li></ul><nav class=paginav><a class=prev href=https://example.net/posts/reddit/><span class=title>« Prev</span><br><span>automating youtube shorts with python</span>
</a><a class=next href=https://example.net/posts/function_calling/><span class=title>Next »</span><br><span>introduction to openai function calling</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://example.net/>xie</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>